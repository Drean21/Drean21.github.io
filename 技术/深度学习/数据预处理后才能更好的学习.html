<!DOCTYPE html>
<html><head>
<title>数据预处理后才能更好的学习</title>
<base href="../..">
<meta id="root-path" root-path="../..">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
<meta charset="UTF-8">
<meta name="description" content="尘影迹痕 - 数据预处理后才能更好的学习">
<meta property="og:title" content="数据预处理后才能更好的学习">
<meta property="og:description" content="尘影迹痕 - 数据预处理后才能更好的学习">
<meta property="og:type" content="website">
<meta property="og:url" content="https://blog.cytl2.eu.org/技术/深度学习/数据预处理后才能更好的学习.html">
<meta property="og:image" content="undefined">
<meta property="og:site_name" content="尘影迹痕">
<meta name="author" content="lzy"><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://blog.cytl2.eu.org/lib/rss.xml"></head><body class="publish css-settings-manager theme-light show-inline-title h2-underline tbMH-yuan tbMH-qk tbMH-ds-cg tbMH-kd-ncc-jy is-focused"><include src="lib/html/custom-head-content.html"></include><script async="" id="webpage-script" src="lib/scripts/webpage.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script type="module" async="" id="graph-view-script" src="lib/scripts/graph-view.js"></script><script async="" id="graph-wasm-script" src="lib/scripts/graph-wasm.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="graph-render-worker-script" src="lib/scripts/graph-render-worker.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="tinycolor-script" src="lib/scripts/tinycolor.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><script async="" id="pixi-script" src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.4.0/pixi.min.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="icon" href="lib/media/favicon.svg"><script async="" id="graph-data-script" src="lib/scripts/graph-data.js" onload="this.onload=null;this.setAttribute(&quot;loaded&quot;, &quot;true&quot;)"></script><link rel="stylesheet" href="lib/styles/obsidian.css"><link rel="preload" href="lib/styles/other-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/other-plugins.css"></noscript><link rel="stylesheet" href="lib/styles/theme.css"><link rel="preload" href="lib/styles/global-variable-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/global-variable-styles.css"></noscript><link rel="preload" href="lib/styles/supported-plugins.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/supported-plugins.css"></noscript><link rel="preload" href="lib/styles/main-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/main-styles.css"></noscript><link rel="preload" href="lib/styles/snippets.css" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="lib/styles/snippets.css"></noscript><style>body{--line-width:40em;--line-width-adaptive:40em;--file-line-width:40em;--sidebar-width:min(20em, 80vw);--collapse-arrow-size:11px;--tree-horizontal-spacing:0.6em;--tree-vertical-spacing:0.6em;--sidebar-margin:12px}.sidebar{height:100%;min-width:calc(var(--sidebar-width) + var(--divider-width-hover));max-width:calc(var(--sidebar-width) + var(--divider-width-hover));font-size:14px;z-index:10;position:relative;overflow:hidden;transition:min-width ease-in-out,max-width ease-in-out;transition-duration:.2s;contain:size}.sidebar-left{left:0}.sidebar-right{right:0}.sidebar.is-collapsed{min-width:0;max-width:0}body.floating-sidebars .sidebar{position:absolute}.sidebar-content{height:100%;min-width:calc(var(--sidebar-width) - var(--divider-width-hover));top:0;padding:var(--sidebar-margin);padding-top:4em;line-height:var(--line-height-tight);background-color:var(--background-secondary);transition:background-color,border-right,border-left,box-shadow;transition-duration:var(--color-fade-speed);transition-timing-function:ease-in-out;position:absolute;display:flex;flex-direction:column}.sidebar:not(.is-collapsed) .sidebar-content{min-width:calc(max(100%,var(--sidebar-width)) - 3px);max-width:calc(max(100%,var(--sidebar-width)) - 3px)}.sidebar-left .sidebar-content{left:0;border-top-right-radius:var(--radius-l);border-bottom-right-radius:var(--radius-l)}.sidebar-right .sidebar-content{right:0;border-top-left-radius:var(--radius-l);border-bottom-left-radius:var(--radius-l)}.sidebar:has(.sidebar-content:empty):has(.topbar-content:empty){display:none}.sidebar-topbar{height:2em;width:var(--sidebar-width);top:var(--sidebar-margin);padding-inline:var(--sidebar-margin);z-index:1;position:fixed;display:flex;align-items:center;transition:width ease-in-out;transition-duration:inherit}.sidebar.is-collapsed .sidebar-topbar{width:calc(2.3em + var(--sidebar-margin) * 2)}.sidebar .sidebar-topbar.is-collapsed{width:0}.sidebar-left .sidebar-topbar{left:0}.sidebar-right .sidebar-topbar{right:0}.topbar-content{overflow:hidden;overflow:clip;width:100%;height:100%;display:flex;align-items:center;transition:inherit}.sidebar.is-collapsed .topbar-content{width:0;transition:inherit}.clickable-icon.sidebar-collapse-icon{background-color:transparent;color:var(--icon-color-focused);padding:0!important;margin:0!important;height:100%!important;width:2.3em!important;margin-inline:0.14em!important;position:absolute}.sidebar-left .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);right:var(--sidebar-margin)}.sidebar-right .clickable-icon.sidebar-collapse-icon{transform:rotateY(180deg);left:var(--sidebar-margin)}.clickable-icon.sidebar-collapse-icon svg.svg-icon{width:100%;height:100%}.sidebar-section-header{margin:0 0 1em 0;text-transform:uppercase;letter-spacing:.06em}body{transition:background-color var(--color-fade-speed) ease-in-out}.webpage-container{display:flex;flex-direction:row;height:100%;width:100%;align-items:stretch;justify-content:center}.document-container{opacity:1;flex-basis:100%;max-width:100%;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;transition:opacity .2s ease-in-out;contain:inline-size}.hide{opacity:0;transition:opacity .2s ease-in-out}.document-container>.markdown-preview-view{margin:var(--sidebar-margin);margin-bottom:0;width:100%;width:-webkit-fill-available;width:-moz-available;width:fill-available;background-color:var(--background-primary);transition:background-color var(--color-fade-speed) ease-in-out;border-top-right-radius:var(--window-radius,var(--radius-m));border-top-left-radius:var(--window-radius,var(--radius-m));overflow-x:hidden!important;overflow-y:auto!important;display:flex!important;flex-direction:column!important;align-items:center!important;contain:inline-size}.document-container>.markdown-preview-view>.markdown-preview-sizer{padding-bottom:80vh!important;width:100%!important;max-width:var(--line-width)!important;flex-basis:var(--line-width)!important;transition:background-color var(--color-fade-speed) ease-in-out;contain:inline-size}.markdown-rendered img:not([width]),.view-content img:not([width]){max-width:100%;outline:0}.document-container>.view-content.embed{display:flex;padding:1em;height:100%;width:100%;align-items:center;justify-content:center}.document-container>.view-content.embed>*{max-width:100%;max-height:100%;object-fit:contain}:not(h1,h2,h3,h4,h5,h6):has(> :is(.math,table)){overflow-x:auto!important}.document-container>.view-content{overflow-x:auto;contain:content;padding:0;margin:0;height:100%}.scroll-highlight{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1000;background-color:hsla(var(--color-accent-hsl),.25);opacity:0;padding:1em;inset:50%;translate:-50% -50%;border-radius:var(--radius-s)}</style><script defer="">async function loadIncludes(){if("file:"!=location.protocol){let e=document.querySelectorAll("include");for(const t of e){let e=t.getAttribute("src");try{const o=await fetch(e);if(!o.ok){console.log("Could not include file: "+e),t?.remove();continue}let l=await o.text(),n=document.createRange().createContextualFragment(l),c=Array.from(n.children);for(let e of c)e.classList.add("hide"),e.style.transition="opacity 0.5s ease-in-out",setTimeout((()=>{e.classList.remove("hide")}),10);t.before(n),t.remove(),console.log("Included file: "+e)}catch(o){t?.remove(),console.log("Could not include file: "+e,o);continue}}}else{if(document.querySelectorAll("include").length>0){var e=document.createElement("div");e.id="error",e.textContent="Web server exports must be hosted on an http / web server to be viewed correctly.",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="1.5em",e.style.fontWeight="bold",e.style.textAlign="center",document.body.appendChild(e),document.querySelector(".document-container")?.classList.remove("hide")}}}document.addEventListener("DOMContentLoaded",(()=>{loadIncludes()}));let isFileProtocol="file:"==location.protocol;function waitLoadScripts(e,t){let o=e.map((e=>document.getElementById(e+"-script"))),l=0;!function e(){let n=o[l];l++,n&&"true"!=n.getAttribute("loaded")||l<o.length&&e(),l<o.length?n.addEventListener("load",e):t()}()}</script><script defer="">let theme=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");"dark"==theme?(document.body.classList.add("theme-dark"),document.body.classList.remove("theme-light")):(document.body.classList.add("theme-light"),document.body.classList.remove("theme-dark")),window.innerWidth<480?document.body.classList.add("is-phone"):window.innerWidth<768?document.body.classList.add("is-tablet"):window.innerWidth<1024?document.body.classList.add("is-small-screen"):document.body.classList.add("is-large-screen")</script><div class="webpage-container workspace"><div class="sidebar-left sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"></div><script defer="">let ls = document.querySelector(".sidebar-left"); ls.classList.add("is-collapsed"); if (window.innerWidth > 768) ls.classList.remove("is-collapsed"); ls.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-left-width"));</script></div><div class="document-container markdown-reading-view hide"><div class="markdown-preview-view markdown-rendered allow-fold-headings allow-fold-lists is-readable-line-width"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section"><h1 class="page-title heading inline-title" id="1. 概述"><ol>
<li>概述</li>
</ol></h1><div class="heading-wrapper"><div class="heading-children"><div><p>深度学习数据预处理是深度学习任务中至关重要的一步，它涉及到将原始数据转换为可以输入模型的形式，并进行适当的清理和转换。正确的预处理可以提高模型的效果和泛化能力，减少模型过拟合的风险。深度学习数据预处理包括数据清理、数据集划分、特征提取、数据转换和数据增强等步骤。</p></div></div></div><div class="heading-wrapper"><h1 data-heading="2. 数据清理" class="heading" id="2._数据清理">2. 数据清理</h1><div class="heading-children"><div><p>在深度学习任务中，数据清理是指清除或修复数据中的异常、错误或缺失值，以保证数据的准确性和完整性。常见的数据清理方法包括：</p></div><div><ul>
<li data-line="0">删除包含缺失值的样本或特征。</li>
<li data-line="1">对缺失值进行填充，比如使用均值、中位数、众数等。</li>
<li data-line="2">对异常值进行修正或删除，比如使用分位数、Z-score等。</li>
<li data-line="3">进行数据类型转换，比如将字符串类型转换为数字类型。</li>
</ul></div></div></div><div class="heading-wrapper"><h1 data-heading="3. 数据集划分" class="heading" id="3._数据集划分">3. 数据集划分</h1><div class="heading-children"><div><p>在深度学习任务中，通常需要将数据集划分为训练集、验证集和测试集。训练集用于训练模型，验证集用于调整模型参数，测试集用于评估模型的性能。通常的比例是70%的数据用于训练，10%的数据用于验证，20%的数据用于测试。</p></div><div><p>数据集划分的目的是评估模型在新数据上的性能，因此需要保证每个数据集的样本数量和类别分布都与原始数据集相同。</p></div></div></div><div class="heading-wrapper"><h1 data-heading="4. 特征提取" class="heading" id="4._特征提取">4. 特征提取</h1><div class="heading-children"><div><p>在深度学习任务中，特征提取是将原始数据转换为更有意义和易于处理的特征，从而更好地利用数据。对于不同类型的数据，特征提取的方法也不同：</p></div><div><ul>
<li data-line="0">对于图像数据，可以使用卷积神经网络（CNN）来提取特征。</li>
<li data-line="1">对于文本数据，可以使用词袋模型、TF-IDF等方法来提取特征。</li>
</ul></div></div></div><div class="heading-wrapper"><h1 data-heading="5. 数据转换" class="heading" id="5._数据转换">5. 数据转换</h1><div class="heading-children"><div><p>在深度学习任务中，需要将数据转换为可以输入模型的形式，比如将图像转换为张量，将文本转换为向量等。对于图像数据，可以将图像转换为张量，并进行归一化。对于文本数据，可以使用词嵌入模型将文本转换为向量。</p></div></div></div><div class="heading-wrapper"><h1 data-heading="6. 数据增强" class="heading" id="6._数据增强">6. 数据增强</h1><div class="heading-children"><div><p>在深度学习任务中，通常需要进行数据增强，还会涉及数据标准化操作</p></div><div><p>接下来，我们将对MNIST数据集进行数据增强和标准化处理。</p></div><div class="heading-wrapper"><h2 data-heading="数据增强" class="heading" id="数据增强"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>数据增强</h2><div class="heading-children"><div><p>数据增强是指通过对原始数据进行一系列随机变换，从而产生更多、更具多样性的训练数据的技术。数据增强可以有效地防止过拟合，提高模型的泛化能力。</p></div><div><p>在深度学习中，常见的数据增强方法有：翻转、旋转、剪切、平移、缩放等。以MNIST数据集为例，我们可以对图像进行水平翻转、随机旋转、随机剪切等操作。</p></div><div><p>具体实现可以使用Keras提供的ImageDataGenerator类。下面是一个示例代码：</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> ImageDataGenerator

datagen <span class="token operator">=</span> ImageDataGenerator<span class="token punctuation">(</span>
        rotation_range<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>  <span class="token comment"># 随机旋转角度</span>
        width_shift_range<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>  <span class="token comment"># 随机水平平移</span>
        height_shift_range<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>  <span class="token comment"># 随机竖直平移</span>
        shear_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token comment"># 随机剪切变换</span>
        zoom_range<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>  <span class="token comment"># 随机缩放</span>
        horizontal_flip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 随机水平翻转</span>
        fill_mode<span class="token operator">=</span><span class="token string">'nearest'</span><span class="token punctuation">)</span>  <span class="token comment"># 填充方式</span>

datagen<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span>  <span class="token comment"># 对训练集进行数据增强</span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>上述代码中，rotation_range指定了随机旋转的角度范围，width_shift_range和height_shift_range指定了随机平移的范围，shear_range指定了随机剪切的程度，zoom_range指定了随机缩放的程度，horizontal_flip指定了是否随机水平翻转，fill_mode指定了填充方式。</p></div><div><p>调用fit方法可以对训练集进行数据增强。</p></div></div></div><div class="heading-wrapper"><h2 data-heading="标准化处理" class="heading" id="标准化处理"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>标准化处理</h2><div class="heading-children"><div><p>标准化处理是将数据转换为均值为0、标准差为1的分布，使得数据分布更加集中、更易于训练。在深度学习中，数据的标准化是非常重要的一步。</p></div><div><p>对于MNIST数据集，我们可以对每个像素的数值进行标准化处理。具体实现如下：</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded">x_train <span class="token operator">=</span> x_train<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>  <span class="token comment"># 将训练集数据转换为0-1之间的浮点数并进行标准化</span>
x_test <span class="token operator">=</span> x_test<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'float32'</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span>  <span class="token comment"># 将测试集数据转换为0-1之间的浮点数并进行标准化</span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>上述代码中，将训练集和测试集的数据类型转换为浮点型，并将像素值除以255，将像素值缩放到0-1之间，从而实现了标准化处理。</p></div><div><p>通过数据增强和标准化处理，我们可以获得更</p></div><div><p>五、代码实践</p></div><div><p>下面我们将利用Python和PyTorch对MNIST数据集进行预处理，包括数据集的下载、数据集的读取和预处理。</p></div><div><ol>
<li data-line="0">数据集的下载和读取</li>
</ol></div><div><p>PyTorch已经内置了MNIST数据集，可以通过torchvision.datasets模块直接获取。如果本地没有数据集，则PyTorch会自动进行下载。</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> torchvision
<span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>transforms <span class="token keyword">as</span> transforms

transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.3081</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

trainset <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span>root<span class="token operator">=</span><span class="token string">'./data'</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                        download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform<span class="token punctuation">)</span>
trainloader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>trainset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>
                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

testset <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span>root<span class="token operator">=</span><span class="token string">'./data'</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                                       download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform<span class="token punctuation">)</span>
testloader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>testset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>
                                         shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">复制</button></pre></div><div><ol>
<li data-line="0">数据集的预处理</li>
</ol></div><div><p>通过上面的代码，我们已经完成了MNIST数据集的下载和读取，接下来我们对数据集进行预处理，主要包括以下几个方面。</p></div><div><p>2.1 数据归一化</p></div><div><p>对于每个像素点，我们需要将其从[0,255]的值归一化到[-1,1]的范围内，以便更好地进行训练。</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded">transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>
    <span class="token punctuation">[</span>transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
     transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.3081</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>2.2 数据增强</p></div><div><p>为了增加模型的泛化能力，我们可以对数据进行增强，比如随机裁剪、随机翻转、随机旋转等。</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded">pythonCopy codetransform_train <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
    transforms<span class="token punctuation">.</span>RandomCrop<span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">,</span> padding<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    transforms<span class="token punctuation">.</span>RandomHorizontalFlip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0.1307</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0.3081</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

trainset <span class="token operator">=</span> torchvision<span class="token punctuation">.</span>datasets<span class="token punctuation">.</span>MNIST<span class="token punctuation">(</span>root<span class="token operator">=</span><span class="token string">'./data'</span><span class="token punctuation">,</span> train<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                                        download<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> transform<span class="token operator">=</span>transform_train<span class="token punctuation">)</span>
trainloader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>trainset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>
                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">复制</button></pre></div><div><p>2.3 数据集划分</p></div><div><p>为了进行模型的评估，我们需要将数据集划分为训练集和测试集。一般情况下，训练集占总数据集的80%，测试集占20%。</p></div><div><pre class="language-python" tabindex="0"><code class="language-python is-loaded">trainset<span class="token punctuation">,</span> valset <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>random_split<span class="token punctuation">(</span>trainset<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">48000</span><span class="token punctuation">,</span> <span class="token number">12000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

trainloader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>trainset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>
                                          shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
valloader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>valset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>
                                          shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
testloader <span class="token operator">=</span> torch<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data<span class="token punctuation">.</span>DataLoader<span class="token punctuation">(</span>testset<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>
                                         shuffle<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code><button class="copy-code-button">复制</button></pre></div></div></div></div></div><div class="heading-wrapper"><h1 data-heading="总结" class="heading" id="总结">总结</h1><div class="heading-children"><div><p>深度学习数据预处理是深度学习中非常重要的一步，可以对模型的训练和预测性能产生非常大的影响。本文主要介绍了深度学习数据预处理的基本概念和常用技巧，包括数据归一化、数据增强、数据清洗和数据集划分等。在实践中，我们可以根据具体的任务和数据特点选择合适的预处理方法。</p></div><div><p>其中，数据归一化是一种基本的预处理方法，可以将数据缩放到合适的范围内，避免数值过大或过小对模型产生的负面影响。另外，数据增强可以有效地增加训练数据的多样性，提高模型的泛化能力。而数据清洗则是在数据中去除异常值、缺失值等不合法的数据样本，保证训练数据的质量。</p></div><div><p>在对数据集进行划分时，我们需要注意训练集、验证集和测试集的划分比例，通常建议将数据集划分为70%训练集、15%验证集和15%测试集。同时，在进行数据预处理时，我们需要保证在测试集上的数据处理方式与训练集相同，以确保模型能够正确地处理新的数据。</p></div><div><p>最后，需要指出的是，深度学习数据预处理是一个非常灵活和实用的技术，在不同的场景中需要采用不同的预处理策略。因此，在实践中需要根据具体情况进行调整和优化，以达到更好的模型性能。</p></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-handle"></div><div class="sidebar-topbar"><div class="topbar-content"></div><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" class="hide" width="512px" height="512px"></canvas>
		</div>
		</div></div><div class="outline-tree tree-container"><div class="tree-item nav-folder mod-root" data-depth="0"><div class="tree-item-self nav-folder-title"><div class="tree-item-inner nav-folder-title-content">Table Of Contents</div><button class="clickable-icon nav-action-button tree-collapse-all" aria-label="Collapse All"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-item-children nav-folder-children"><div class="nav-folder-spacer"></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#1. 概述" data-path="#1. 概述"><div class="tree-item-inner heading-link" heading-name="
概述
">概述</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#2._数据清理" data-path="#2._数据清理"><div class="tree-item-inner heading-link" heading-name="2. 数据清理">2. 
数据清理
</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#3._数据集划分" data-path="#3._数据集划分"><div class="tree-item-inner heading-link" heading-name="3. 数据集划分">3. 
数据集划分
</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#4._特征提取" data-path="#4._特征提取"><div class="tree-item-inner heading-link" heading-name="4. 特征提取">4. 
特征提取
</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#5._数据转换" data-path="#5._数据转换"><div class="tree-item-inner heading-link" heading-name="5. 数据转换">5. 
数据转换
</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#6._数据增强" data-path="#6._数据增强"><div class="tree-item-inner heading-link" heading-name="6. 数据增强">6. 
数据增强
</div></a><div class="tree-item-children"><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#数据增强" data-path="#数据增强"><div class="tree-item-inner heading-link" heading-name="数据增强">数据增强</div></a><div class="tree-item-children"></div></div><div class="tree-item" data-depth="2"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#标准化处理" data-path="#标准化处理"><div class="tree-item-inner heading-link" heading-name="标准化处理">标准化处理</div></a><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="1"><a class="tree-item-self is-clickable" href="技术/深度学习/数据预处理后才能更好的学习.html#总结" data-path="#总结"><div class="tree-item-inner heading-link" heading-name="总结">总结</div></a><div class="tree-item-children"></div></div></div></div></div></div><script defer="">let rs = document.querySelector(".sidebar-right"); rs.classList.add("is-collapsed"); if (window.innerWidth > 768) rs.classList.remove("is-collapsed"); rs.style.setProperty("--sidebar-width", localStorage.getItem("sidebar-right-width"));</script></div></div></body></html>